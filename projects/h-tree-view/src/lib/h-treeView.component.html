<cdk-virtual-scroll-viewport itemSize="50">
  <div class="h-treeView__droplist">
    <ng-container *hVirtualFor="let item of items">
      <ng-container *ngTemplateOutlet="hTreeItemTemplate; context: { item: item }"></ng-container>
    </ng-container>
  </div>
</cdk-virtual-scroll-viewport>

<ng-template #hTreeItemTemplate let-item="item">
  <li class="h-treeView"
    [ngClass]="{
      'active': item.selected,
      'disabled': item.disabled
    }"
    [ngStyle]="{
      '--level': item.level - 1
    }">
    <div class="h-treeView__toggler" (click)="toggle(item)">
      <ng-container *ngTemplateOutlet="toggleRef; context: { item: item }"></ng-container>
    </div>

    <div class="h-treeView__item" (click)="clickNode(item)">
      <ng-container *ngIf="itemTemplate">
        <ng-container *ngTemplateOutlet="itemTemplate; context: { item: item }"></ng-container>
      </ng-container>

      <ng-container *ngIf="!itemTemplate">
        {{ item.label }}
      </ng-container>
    </div>
  </li>
</ng-template>

<ng-template #toggleRef let-item="item">
  <ng-container *ngIf="item?.children?.length">
    <ng-container *ngIf="item.expanded">
      <mat-icon aria-hidden="false" fontIcon="arrow_drop_down"></mat-icon>
    </ng-container>

    <ng-container *ngIf="!item.expanded">
      <mat-icon aria-hidden="false" fontIcon="arrow_right"></mat-icon>
    </ng-container>
  </ng-container>
</ng-template>
